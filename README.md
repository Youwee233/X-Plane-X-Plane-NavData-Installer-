# X-Plane 导航数据安装器 (X-Plane NavData Installer)
<h2><font color="red"><strong>本项目完全由 Gemini 生成，下载使用前请自行检查代码内容，下载使用带来的一切后果自负。</strong></font></h2>
本项目是一款专为X-Plane玩家设计的导航数据自动化分发工具。它能够自动处理压缩包内的嵌套结构，实现一键式安装，解决手动解压、移动文件的繁琐流程。

## 核心功能

1. 自动化二次解压：支持识别并解压 RAR 主包内嵌套的 ZIP 子压缩包。
2. 增量覆盖安装：采用文件合并逻辑，仅更新导航数据文件，保留目标文件夹内已有的其他文件。
3. 可视化管理菜单：双击脚本即可进入管理模式，支持配置解压引擎路径、开关自动删除功能及编辑安装规则。
4. 自动生成入口：首次运行将自动在本地生成快捷方式，支持通过“拖拽”操作触发安装流程。

## 环境要求

使用本工具前，请确保电脑已安装以下软件：

1. Python 3.x：请前往 Python 官网下载并安装。
2. Bandizip：本工具的解压引擎，请确保已安装。
   - 注意：如果 Bandizip 未安装在默认路径，需在程序菜单中手动指定其安装位置。

## 安装与使用

### 1. 安装依赖库
在项目文件夹内打开终端（Command Prompt 或 PowerShell），执行以下命令安装必要的 Windows 库：
```bash
pip install pywin32

```

### 2. 初始化配置

直接运行 `main.py` 脚本：

* 程序启动后将自动生成 `rules_config.ini` 配置文件。（注：如果没有生成，修改任意一项设置并保存后就有了）
* 程序将在当前目录下自动创建一个名为“X-Plane 导航数据安装器.lnk”的快捷方式。
* 在弹出的管理菜单中，根据您的模拟器路径添加对应的安装规则。

### 3. 执行安装

将下载好的导航数据压缩包（RAR、7Z 或 ZIP 格式）直接拖动到“X-Plane 导航数据安装器”快捷方式图标上，程序将自动开始分析并分发数据。此外，双击此快捷方式可以直接打开管理页面，更容易的修改配置。

## 规则配置说明

在管理菜单中添加规则时，名称需对应压缩包内子 ZIP 文件的名称（不含后缀）：

| 规则名称 (ZIP文件名) | 目标安装目录示例 |
| --- | --- |
| X-Plane 12 | D:\X-Plane 12\Custom Data |
| FENIX A320 | D:\MSFS\Community\fnx-aircraft-320\NavData |
| PMDG MSFS | D:\MSFS\Community\pmdg-aircraft-738\NavData |
| ZIBO 737 | D:\X-Plane 12\Aircraft\B737-800X\db |

## 配置文件 (rules_config.ini) 详解

用户也可以通过文本编辑器直接修改生成的配置文件：

* autodeletearchive: 设置为 True 将在处理完成后自动删除原始压缩包，设置为 False 则保留原包。
* bandizippath: 指向 Bandizip.exe 的绝对物理路径。


## 许可协议

本项目采用 **MIT License** 许可协议。<br>
本工具仅供飞行模拟爱好者交流学习使用，严禁用于任何商业用途。作者不对因使用本工具导致的文件丢失或系统问题负责。
